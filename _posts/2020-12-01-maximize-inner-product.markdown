---
layout: post
title:  "最大化两向量的内积"
date:   2020-12-01 21:28:00 -0800
categories: algorithm
---
* TOC
{:toc}

# 问题

已知长度为 $$ N $$ 的两个向量
$$ \vec{X} = \left (x_1, x_2, x_3, ..., x_i, ..., x_n \right ) $$,
$$ \vec{Y} = \left (y_1, y_2, y_3, ..., y_i, ..., y_n \right ) $$
并且 $$ x_i > 0, y_i > 0 $$, $$ \vec{X} $$ 和 $$ \vec{Y} $$ 向量内的数可以随机排列，
求 $$ \vec{X} $$ 向量与 $$ \vec{Y} $$ 向量点积的最大值。

# 简化分析

先考虑简化情况下的解法，假设我们有两个长度为 2 的向量
$$ \vec{A} = \{x_1, x_2\} $$,
$$ \vec{B} = \{y_1, y_2\} $$, 并且
$$ x_1 < x_2, y_1 < y_2 $$. 这种情况下的解答比较简单，可以通过代数或者数型结合的办法证明
$$ x_2 * y_2 $$ 是最大的内积，$$ x_1 * y_1 $$ 是最小的内积。

将 $$ \vec{X} $$ 和 $$ \vec{Y} $$ 向量内的数排好序

$$ x_1 < x_2 < ... < x_i < ... < x_n, $$

$$ y_1 < y_2 < ... < y_i < ... < y_n. $$


那么，最大的内积为

$$ \sum_{i=1}^{n} x_i * y_i,	$$

最小的内积为

$$ \sum_{i=1}^{n} x_i * y_{n+1-i},	$$

下面详细证明。

# 最大化内积

反证法。假设 $$ \sum_{i=1}^{n} x_i * y_i	$$ 不是最大的内积，$$ S $$ 才是最大的，
那在这个内积 $$ S $$ 的 $$ N $$ 项中一定存在
$$ x_a * y_d $$ 和 $$ x_b * y_c $$ 使得 $$ a < b $$ 且 $$ c < d $$。

根据简化分析的结论，我们可以得到

$$ T = S - (x_a * y_d + x_b * y_c) + (x_a * y_c + x_b * y_d) > S, $$

可以将 $$ S $$ 可视化如下图所示

![max-inner-product](/assets/images/max-inner-product.png){: .center}

$$ T > S $$ 与 $$ S $$ 是最大的内积矛盾，证毕。

# 最小化内积

类似反证法。我们可以从 $$ x_n $$ 枚举到 $$ x_1 $$, 找到对应的 $$ y_j $$ 相乘。
比如对于 $$ x_n $$, 只有当 $$ x_n $$ 和 $$ y_1 $$ 相乘才可以使得最后的内积最小。
否则最后的内积中会有 $$ x_n * y_b + x_a * y_1 $$，然后我们可以再次借助简化分析中的结论，
将这两项换为 $$ x_n * y_1 + x_a * y_b $$ 来使得最后的内积变小。
对于 $$ i < n $$ 的 $$ x_i $$, 以此类推，我们便可以得到
$$ \sum_{i=1}^{n} x_i * y_{n+1-i}	$$ 是最小的内积。
